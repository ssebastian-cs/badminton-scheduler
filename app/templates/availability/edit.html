{% extends "base.html" %}

{% block title %}Edit Availability - Badminton Scheduler{% endblock %}

{% block content %}
<div class="max-w-2xl mx-auto">
    <div class="mb-8 text-center sm:text-left">
        <h1 class="text-2xl sm:text-3xl font-bold text-neon-green mb-2 shadow-neon">
            <span class="mr-2">✏️</span>Edit Availability
        </h1>
        <div class="text-gray-400 text-sm sm:text-base bg-dark-gray rounded-lg p-3 border border-gray-700">
            {% if availability.user_id == current_user.id %}
                <span class="flex items-center">
                    <span class="mr-2">📝</span>
                    Update your availability for <span class="text-neon-green font-medium ml-1">{{ availability.date.strftime('%B %d, %Y') }}</span>
                </span>
            {% else %}
                <span class="flex items-center">
                    <span class="mr-2">👨‍💼</span>
                    Editing <span class="text-white font-medium mx-1">{{ availability.user.username }}'s</span> availability for 
                    <span class="text-neon-green font-medium ml-1">{{ availability.date.strftime('%B %d, %Y') }}</span>
                    <span class="ml-2 bg-neon-green text-black px-2 py-1 rounded text-xs font-bold">ADMIN</span>
                </span>
            {% endif %}
        </div>
    </div>

    <div class="bg-dark-gray rounded-lg shadow-lg p-6 border border-gray-700">
        <form method="POST" class="space-y-6">
            {{ form.hidden_tag() }}
            
            <div class="bg-gray-800 rounded-lg p-4">
                <div class="flex items-center mb-3">
                    <span class="text-neon-green mr-2">📅</span>
                    {{ form.date.label(class="text-sm font-medium text-gray-300") }}
                </div>
                {{ form.date(class="w-full bg-gray-900 border border-gray-600 text-white rounded-lg px-4 py-3 focus:ring-neon-green focus:border-neon-green transition-colors text-lg") }}
                {% if form.date.errors %}
                    <div class="mt-2">
                        {% for error in form.date.errors %}
                            <p class="text-red-400 text-sm flex items-center">
                                <span class="mr-1">⚠️</span>{{ error }}
                            </p>
                        {% endfor %}
                    </div>
                {% endif %}
                <p class="mt-2 text-xs text-gray-400 flex items-center">
                    <span class="mr-1">💡</span>Select a future date when you'll be available
                </p>
            </div>

            <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                <div class="bg-gray-800 rounded-lg p-4">
                    <div class="flex items-center mb-3">
                        <span class="text-neon-green mr-2">🕐</span>
                        {{ form.start_time.label(class="text-sm font-medium text-gray-300") }}
                    </div>
                    {{ form.start_time(class="w-full bg-gray-900 border border-gray-600 text-white rounded-lg px-4 py-3 focus:ring-neon-green focus:border-neon-green transition-colors text-lg") }}
                    {% if form.start_time.errors %}
                        <div class="mt-2">
                            {% for error in form.start_time.errors %}
                                <p class="text-red-400 text-sm flex items-center">
                                    <span class="mr-1">⚠️</span>{{ error }}
                                </p>
                            {% endfor %}
                        </div>
                    {% endif %}
                </div>

                <div class="bg-gray-800 rounded-lg p-4">
                    <div class="flex items-center mb-3">
                        <span class="text-neon-green mr-2">🕐</span>
                        {{ form.end_time.label(class="text-sm font-medium text-gray-300") }}
                    </div>
                    {{ form.end_time(class="w-full bg-gray-900 border border-gray-600 text-white rounded-lg px-4 py-3 focus:ring-neon-green focus:border-neon-green transition-colors text-lg") }}
                    {% if form.end_time.errors %}
                        <div class="mt-2">
                            {% for error in form.end_time.errors %}
                                <p class="text-red-400 text-sm flex items-center">
                                    <span class="mr-1">⚠️</span>{{ error }}
                                </p>
                            {% endfor %}
                        </div>
                    {% endif %}
                </div>
            </div>

            <div class="flex flex-col sm:flex-row gap-4 pt-6">
                {{ form.submit(class="bg-neon-green text-black px-8 py-3 rounded-lg font-medium hover:bg-green-400 hover:shadow-neon-lg transition-all cursor-pointer shadow-neon text-center", value="✅ Update Availability") }}
                <a href="{{ url_for('availability.dashboard') }}" 
                   class="bg-gray-700 text-white px-8 py-3 rounded-lg font-medium hover:bg-gray-600 hover:text-neon-green transition-all text-center border border-gray-600 hover:border-neon-green">
                    ❌ Cancel
                </a>
            </div>
        </form>
    </div>

    <!-- Current Details -->
    <div class="mt-8 bg-gray-800 rounded-lg p-4 sm:p-6 border border-gray-700">
        <h3 class="text-lg font-medium text-white mb-4 flex items-center">
            <span class="mr-2">📋</span>Current Details
        </h3>
        <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 text-gray-300 text-sm">
            <div class="space-y-3">
                <div class="flex items-center">
                    <span class="text-neon-green mr-2">👤</span>
                    <span class="font-medium text-white">User:</span>
                    <span class="ml-2">{{ availability.user.username }}</span>
                    {% if availability.user.is_admin() %}
                        <span class="ml-2 bg-neon-green text-black px-2 py-1 rounded text-xs font-bold">ADMIN</span>
                    {% endif %}
                </div>
                <div class="flex items-center">
                    <span class="text-neon-green mr-2">📅</span>
                    <span class="font-medium text-white">Original Date:</span>
                    <span class="ml-2">{{ availability.date.strftime('%B %d, %Y') }}</span>
                </div>
                <div class="flex items-center">
                    <span class="text-neon-green mr-2">🕐</span>
                    <span class="font-medium text-white">Original Time:</span>
                    <span class="ml-2">{{ availability.start_time.strftime('%I:%M %p') }} - {{ availability.end_time.strftime('%I:%M %p') }}</span>
                </div>
            </div>
            <div class="space-y-3">
                <div class="flex items-center">
                    <span class="text-neon-green mr-2">📝</span>
                    <span class="font-medium text-white">Created:</span>
                    <span class="ml-2">{{ availability.created_at.strftime('%B %d, %Y at %I:%M %p') }}</span>
                </div>
                {% if availability.updated_at != availability.created_at %}
                <div class="flex items-center">
                    <span class="text-neon-green mr-2">🔄</span>
                    <span class="font-medium text-white">Last Updated:</span>
                    <span class="ml-2">{{ availability.updated_at.strftime('%B %d, %Y at %I:%M %p') }}</span>
                </div>
                {% endif %}
            </div>
        </div>
    </div>
</div>
{% endblock %}